import pandas as pd
import numpy as np

# 风力机叶片几何数据
blade_data = {
    '节点': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    '径向位置(m)': [0.000, 1.367, 4.100, 6.833, 10.250, 14.350, 18.450, 22.550, 26.650, 30.750,
                    34.850, 38.950, 43.050, 47.150, 51.250, 54.667, 57.400, 60.133, 61.500, 61.500],
    '弯曲AC(m)': [0.000, -0.001, -0.025, -0.059, -0.109, -0.116, -0.098, -0.083, -0.068, -0.053,
                  -0.041, -0.030, -0.021, -0.014, -0.008, -0.004, -0.002, -0.000, -0.000, -0.000],
    '后掠AC(m)': [0.000, -0.003, -0.105, -0.251, -0.461, -0.570, -0.549, -0.525, -0.496, -0.465,
                  -0.436, -0.406, -0.376, -0.345, -0.315, -0.289, -0.261, -0.177, -0.177, -0.177],
    '弯曲角(°)': [0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                  0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000],
    '扭转角(°)': [13.308, 13.308, 13.308, 13.308, 13.308, 11.480, 10.162, 9.011, 7.795, 6.544,
                  5.361, 4.188, 3.125, 2.319, 1.526, 0.863, 0.370, 0.106, 0.106, 0.106],
    '弦长(m)': [3.542, 3.542, 3.854, 4.167, 4.557, 4.652, 4.458, 4.249, 4.007, 3.748,
                3.502, 3.256, 3.010, 2.764, 2.518, 2.313, 2.086, 1.419, 1.419, 1.419],
    '翼型ID': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 19]
}

# 创建DataFrame
df = pd.DataFrame(blade_data)

# 显示数据
print("风力机叶片几何数据表:")
print("=" * 80)
print(df.to_string(index=False))

# 保存为CSV文件
df.to_csv('blade_geometry_data.csv', index=False, encoding='utf-8')
print("\n数据已保存为 'blade_geometry_data.csv'")

# 基本统计信息
print("\n数据统计信息:")
print("=" * 40)
print(f"节点总数: {len(df)}")
print(f"叶片长度: {df['径向位置(m)'].max():.3f} m")
print(f"最大弦长: {df['弦长(m)'].max():.3f} m")
print(f"根部扭转角: {df['扭转角(°)'].iloc[0]:.3f}°")
print(f"叶尖扭转角: {df['扭转角(°)'].iloc[-1]:.3f}°")

# 数据验证
print("\n数据验证:")
print("=" * 40)
print("径向位置是否单调递增:", df['径向位置(m)'].is_monotonic_increasing)
print("是否存在缺失值:", df.isnull().any().any())

# 数据访问示例
print("\n数据访问示例:")
print("=" * 40)
print("获取特定节点数据:")
node_10 = df[df['节点'] == 10]
print(f"节点10: 径向位置 = {node_10['径向位置(m)'].values[0]:.3f}m, "
      f"弦长 = {node_10['弦长(m)'].values[0]:.3f}m, "
      f"扭转角 = {node_10['扭转角(°)'].values[0]:.3f}°")

print("\n根据径向位置范围筛选:")
mid_span = df[(df['径向位置(m)'] >= 20) & (df['径向位置(m)'] <= 40)]
print(f"中段叶片({mid_span['径向位置(m)'].min():.1f}m - {mid_span['径向位置(m)'].max():.1f}m):")
print(mid_span[['节点', '径向位置(m)', '弦长(m)', '扭转角(°)']].to_string(index=False))